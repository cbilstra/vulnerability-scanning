import pandas as pd
import time
from io import StringIO

DATA_PATH = "critical_201303_23.json"
NUM_LINES = 1000


def parse():
    t0 = time.time()

    with open(DATA_PATH) as file:
        entries = [next(file) for _ in range(NUM_LINES)]

    sample = StringIO("".join(entries))

    df = pd.read_json(sample, orient="columns", lines=True, encoding="utf_8")
    print(df['ip'])
    print(f"It took {time.time()-t0:.3f} seconds to parse the data.")
    print(df.columns)


if __name__ == '__main__':
    parse()
