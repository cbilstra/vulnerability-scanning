import pandas as pd

def get_version_number(banner):
    return banner.split("\r")[0].split("_")[1]

def vuln_flag(version):
    ver =  int(version.split(".")[1])
    if ver >= 52 and ver <= 54:
        return 1
    
    return 0


def main():
    df = pd.read_pickle("data.pkl")

    dropbear = df[df["banner"].str.contains("dropbear")]

    dropbear['version'] = dropbear.apply (lambda row: get_version_number(row['banner']), axis=1)
    dropbear['vulnerable'] = dropbear.apply (lambda row: vuln_flag(row['version']), axis=1)
    
    dropbear.to_pickle("dropbear.pkl")


if __name__ == '__main__':
    main()
