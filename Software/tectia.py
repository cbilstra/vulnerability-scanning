import re

search_pattern_tectia = re.compile(r'\-(?P<version>\d\.\d\.\d*).+SSH Tectia')


def get_version_number(input_banner: str):
    matches = search_pattern_tectia.search(input_banner)

    if matches is None:
        return None
    return matches.group('version')


def is_vulnerable(input_version) -> bool:
    ver = [int(x) for x in input_version.split('.')]
    
    if ver[0] == 6:
        if ver[1] == 0:
            return 4 <= ver[2] <= 20
        
        if ver[1] == 1:
            return 0 <= ver[2] <= 12

        if ver[1] == 2:
            return 0 <= ver[2] <= 5

        if ver[1] == 3:
            return 0 <= ver[2] <= 2

    return False
